# プロンプト規則集

## 1. プロンプトトリガー一覧

### 1.1 作業終了時（トリガー: 「おつかれ」または「本日の作業の終了」）
1. 知見のまとめ作成
2. メモリバンクの更新
3. ADR作成判断と作成（必要な場合のみ）
4. 週報の作成・更新

### 1.2 知見更新時（自動検知または「知見更新」）
- トリガー：
  1. 自動検知：以下のキーワードを含む文章を検出した場合
     - 「課題が明確になりました」
     - 「重要な発見がありました」
     - 「知見が得られました」
     - 「改善点が見つかりました」
  2. 手動：「知見更新」というキーワード
- 処理：知見のまとめ作成のみ実行

### 1.3 ADR作成時（自動検知または「ADR作成」）
- トリガー：
  1. 自動検知：以下のキーワードを含む文章を検出した場合
     - 「設計方針を決定しました」
     - 「アーキテクチャの変更を決定」
     - 「重要な決定を行いました」
     - 「〜に変更することにしました」
     - 「〜という方針で進めます」
  2. 手動：「ADR作成」というキーワード
- 処理：ADR作成のみ実行

### 1.4 ガイドライン改訂時（トリガー: 「ガイド改訂」）
1. 作業の振り返りと熟考
2. 既存ガイドラインを踏襲した改訂

## 2. 各作業の詳細

### 2.1 知見のまとめ作成
```
場所: docs/logs/ai/knowledge/[開発フェーズ]/YYYY-MM/YYYY-MM-DD-[内容のタイトルの英名].md
手順:
1. まとめ作業前の振り返り
   - 実施内容の全体像を確認
   - 重要な判断ポイントを列挙
   - 発生した課題を整理

2. 熟考のプロセス
   - 各判断の根拠を深掘り
   - 選択肢と比較検討内容を整理
   - 得られた教訓を分析

3. まとめ作成
   - 具体的な課題と解決策
   - 技術的な判断とその根拠
   - 改善案や代替案の検討内容
   - 次のステップへの提案
```

### 2.2 メモリバンクの更新
```
対象:
1. .cline/memory/base/foundation.md
   - 基本となる原則の追加・更新
   - 重要な判断基準の記録
   - 長期的な方針の更新

2. .cline/memory/system/patterns.md
   - 新しいパターンの追加
   - 既存パターンの改善
   - パターン間の関係更新

3. .cline/memory/system/rules.md
   - システムルールの追加・更新
   - 制約条件の明確化
   - 例外処理の定義

4. .cline/memory/context/active.md
   - 現在の状況の更新
   - アクティブな課題の記録
   - 進行中の作業の状態

5. .cline/memory/context/progress.md
   - 進捗状況の更新
   - マイルストーンの記録
   - 次のステップの定義

6. .cline/memory/knowledge/core.md
   - コア知識の蓄積
   - 重要な発見の記録
   - 基本概念の更新

7. .cline/memory/personas/team.md
   - チームメンバーの情報
   - 役割と責任の更新
   - コミュニケーションパターン

8. .cline/memory/architecture/current.md
   - 現在のアーキテクチャ状態
   - 設計決定の履歴
   - 構造的な変更の記録
```

### 2.3 ADR作成
```
場所: docs/logs/ai/adr/[ADRステータス]/[開発フェーズ]/YYYY/YYYY-MM-DD-[決定内容の英名].md

ADRステータス:
- proposed: 提案中
- accepted: 承認済み
- rejected: 却下
- deprecated: 廃止
- superseded: 代替案採用

条件: 以下のいずれかに該当する決定の場合に作成
1. アーキテクチャに影響する決定
   - システム構造の変更
   - コンポーネント間の関係性の変更
   - 重要なインターフェースの変更

2. 重要なパターンや規約の変更
   - 設計パターンの採用
   - コーディング規約の変更
   - 命名規則の変更

3. チーム間の協業方法の変更
   - 開発プロセスの変更
   - コミュニケーション方法の変更
   - 役割分担の変更

4. システム全体に影響する技術選定
   - フレームワークの選定
   - ライブラリの採用
   - ツールチェーンの変更

記録項目：
1. ステータス（proposed/accepted/rejected/deprecated/superseded）
2. 決定に至った背景と理由
3. 検討した代替案
4. 影響範囲の分析
5. 実装手順
```

### 2.4 週報作成・更新
```
場所: docs/logs/work-log/[YYYY]/YYYY-MM_[週の番号].md
注: 週の番号は月の最初の週を1とし、以降順番に2,3,4...と指定

記録内容:
1. 実施内容の収集
   - 前回の週報記録時からの全作業を確認
   - 各コミットログの確認
   - 作成・更新したファイルの確認
   - AIとの対話履歴の確認

2. 記録項目
   - 作業実施時間（HH:MM-HH:MM）
   - 作業内容の要約（前回記録からの全作業）
   - 成果物への参照リンク（存在確認必須）
     - 作成した知見へのリンク
     - 作成したADRへのリンク（存在する場合）
     - 作成・更新したコードへのリンク
     - 作成・更新した資料へのリンク
   - 課題と次のステップ

3. リンク確認プロセス
   1. 各リンク先ファイルの存在確認
   2. 存在しない場合:
      - ユーザーに移動または削除の確認
      - 正しいパスの提供を要求
      - 更新された情報で週報を修正

週番号の計算例:
- 3/1-3/7   → YYYY-MM_1.md
- 3/8-3/14  → YYYY-MM_2.md
- 3/15-3/21 → YYYY-MM_3.md
- 3/22-3/28 → YYYY-MM_4.md
- 3/29-3/31 → YYYY-MM_5.md
```

## 更新履歴

- 2025-03-07: 改訂
  - メモリバンクの更新対象を拡充
  - 各メモリバンクファイルの目的を明確化
  - 更新内容を具体化

- 2025-03-07: 改訂
  - ADRのパス構造を変更
  - ADRステータスを最上位ディレクトリに

- 2025-03-07: 全面改訂
  - プロンプトトリガー一覧を再整理
  - 知見更新の自動検知を追加
  - ADR作成の自動検知を追加
  - 週報作成プロセスを詳細化
  - 週番号の計算方法を明確化
