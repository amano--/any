# Clineルール更新手順（AI用）

## 0. 重要な前提

- ルールのメンテナンスはユーザーの責任です
- AIは分析と改善案作成と更新作業を担当します
- ルールの更新は必ずユーザーの承認が必要です

## 1. ルール改善のトリガー

### 1.1 自動検知

以下のキーワードを含む文章を検出した場合：

- 「ルールの問題点が見つかりました」
- 「ルールの改善が必要です」
- 「ルールの更新を提案します」
- 「ルールの矛盾を発見しました」
- 「ルールの最適化が可能です」

### 1.2 手動トリガー

ユーザーから「ルール改善」命令を受けた場合

## 2. メンバー理解フェーズ

### 2.1 情報収集

1. メンバールールの確認
   ```
   docs/team/[teamName]/member/[userName]/rules/
   ```
   - 00-basic.mdから開始
   - 個人情報セクションを確認
   - 重要セクションを理解
   - タスク関連設定を把握

2. ユーザー特性の把握
   ```yaml
   個人情報:
     基本情報:
       - チーム名
       - ユーザー名
       - 役割

     技術特性:
       - スキルレベル
       - 得意分野
       - 不得意分野

     作業スタイル:
       - プログラミング方針
       - AIとの協業方法
       - 品質管理アプローチ
   ```

### 2.2 理解度確認

1. 完全理解の場合
   - チームルールの確認に進む

2. 部分的理解の場合
   - 不足部分を再確認
   - 必要に応じて質問

3. 不十分な理解の場合
   - すべてのメンバールールを再読了
   - 理解度を報告
   - 承認を得てから次へ

## 3. ルール階層の分析

### 3.1 チームルールの確認
```
docs/team/[teamName]/rules/
```
- メンバールールとの整合性
- チーム固有のプラクティス
- ワークフローの要件

### 3.2 プロジェクトルールの確認
```
docs/setup/cline/rules/detail/
```
- プロジェクトの基本方針
- セキュリティ要件
- 標準プラクティス

## 4. プレビュー作成フェーズ

### 4.1 プレビューファイルの作成
```
docs/setup/cline/logs/ai/advice/[teamName]/[userName]/YYYY-MM/YYYY-MM-DD-HH-clinerules-preview.md
```

### 4.2 プレビュー構造
```markdown
# .clinerules プレビュー

## 1. メンバールール（最優先）
[個人情報とユーザー特性]
[作業プロセスと自動化設定]

## 2. チームルール（次優先）
[チーム共通の規約とプラクティス]

## 3. プロジェクトルール（基盤）
[プロジェクト全体の要件と制約]
```

### 4.3 レビュープロセス

1. 自己チェック
   - メンバー情報の正確性
   - ルール間の整合性
   - 設定の実現可能性

2. ユーザーレビュー依頼
   - 構造の説明
   - 重要ポイントの強調
   - 確認項目の明示

3. フィードバック対応
   - 修正要求への対応
   - 変更履歴の管理
   - 再レビューの実施

## 5. 改善案の作成

### 5.1 AIの熟考プロセス

1. 過去の作業の振り返り
   - 実施したタスクの分析
   - 発生した問題点の整理
   - 非効率な手順の特定
   - エラーが起きやすい箇所の把握

2. ルールの利用状況分析
   - よく使用されるルールの特定
   - 問題が発生しやすい箇所
   - 理解しにくい部分の特定
   - トークン効率の低い箇所

3. 改善方針の検討
   - トークン効率の向上
   - 理解しやすさの改善
   - エラー防止の仕組み
   - 保守性の向上

4. 実装可能性の評価
   - 技術的な実現性
   - 影響範囲の見積もり
   - リスクの分析
   - 効果の予測

### 5.2 改善提案の作成と保存

1. ファイル名規則
```
docs/setup/cline/logs/ai/advice/[teamName]/[userName]/YYYY-MM/YYYY-MM-DD-HH-[改善内容の英名].md
```

2. 提案フォーマット

```markdown
# [改正したいルールのタイトル]改善提案

## 1. 変更内容
[変更の具体的な内容]

## 2. 変更理由
[なぜこの変更が最適なのか]

## 3. 影響範囲
[この変更が影響を与える範囲]

## 4. 期待される効果
[変更による具体的な改善点]
```

### 5.3 提案時の注意点

- 具体的な改善内容を示す
- 変更の理由を明確に説明
- トークン削減効果を予測
- 影響範囲を明示

## 6. .clinerules生成フェーズ

### 6.1 生成前の最終確認

1. ユーザー特性の反映
   - 作業スタイルの考慮
   - 重要な注意点
   - 自動化設定

2. ルール階層の確認
   - 優先順位の正確性
   - 依存関係の整理
   - 矛盾の有無

3. セキュリティチェック
   - 機密情報の扱い
   - アクセス制御
   - エラー処理

### 6.2 生成と検証

1. ファイル生成
   - 承認済みプレビューに基づく生成
   - 形式の検証
   - リンクの確認

2. 動作確認
   - 基本機能の確認
   - エラーケースのテスト
   - パフォーマンスの確認

3. 最終承認
   - ユーザーによる確認
   - 必要に応じた調整
   - 承認の記録

## 7. 継続的改善

### 7.1 作業記録の管理

1. ログの保存
   - 作業プロセス
   - 決定事項
   - 重要な注意点

2. 知見の蓄積
   - 効果的な方法
   - 発生した問題
   - 改善アイデア

### 7.2 プロセス改善

1. 定期的な見直し
   - 手順の最適化
   - テンプレートの更新
   - ツールの改善

2. フィードバックの反映
   - ユーザーからの提案
   - 効率化の検討
   - 新規要件の取り込み
