# Clineルール更新手順（AI用）

## 0. 重要な前提

- ルールのメンテナンスはユーザーの責任です
- AIは分析と改善案作成と更新作業を担当します
- ルールの更新は必ずユーザーの承認が必要です

## 1. ルール改善のトリガー

### 1.1 自動検知

以下のキーワードを含む文章を検出した場合：

- 「ルールの問題点が見つかりました」
- 「ルールの改善が必要です」
- 「ルールの更新を提案します」
- 「ルールの矛盾を発見しました」
- 「ルールの最適化が可能です」

### 1.2 手動トリガー

ユーザーから「ルール改善」命令を受けた場合

### 1.5 計画書作成フェーズ

#### 1.5.1 計画書フォーマット参照
AIは以下のファイルのフォーマットを厳密に遵守すること：
```
docs/setup/cline/update-guide/ai/create-clinerules-plan.md
```

#### 1.5.2 計画書作成プロセス
1. ルールファイルの確認
   - 00-personal.md の構造確認
   - 01-team.md の構造確認
   - 02-project.md の構造確認

2. 計画書の構造設計
   - 前提確認セクション
   - 作業計画セクション
   - 検証計画セクション

3. エラー防止メカニズムの組込
   - 確認ポイントの設定
   - エラー対応の定義
   - 実装前検証項目の準備

#### 1.5.3 計画書の保存
```
docs/setup/cline/logs/ai/advice/[teamName]/[userName]/YYYY-MM-DD-HH-clinerules-plan.md
```

## 2. メンバー理解フェーズ

### 2.1 情報収集

1. メンバールールの確認
   ```
   docs/team/[teamName]/member/[userName]/rules/
   ```
   - 00-basic.mdから開始
   - 個人情報セクションを確認
   - タスク関連設定を把握
   - AIとの協業方法を理解

2. 段階的な理解度チェック
   ```yaml
   確認項目:
     基本情報:
       - チーム名
       - ユーザー名
       - 役割

     技術特性:
       - スキルレベル
       - 得意分野
       - 不得意分野

     作業スタイル:
       - プログラミング方針 
       - AIとの協業方法
       - 品質管理アプローチ
   ```

### 2.2 理解度確認

1. 完全理解の場合
   - すべての要件を把握
   - 具体的な適用方法を理解
   - 次のフェーズに進行可能

2. 部分的理解の場合
   - 不足部分の特定
   - 追加確認事項の整理
   - 再確認の実施

3. 不十分な理解の場合
   - 全体的な再確認
   - 理解度のレポート
   - 承認後に次へ進行

## 3. ルール階層の分析

### 3.1 チームルールの確認

```
docs/team/[teamName]/rules/
```

チェック項目：
- メンバールールとの整合性
- チーム固有のプラクティス
- ワークフローの要件

### 3.2 プロジェクトルールの確認

```
docs/setup/cline/rules/detail/
```

チェック項目：
- プロジェクトの基本方針
- セキュリティ要件
- 標準プラクティス

## 4. プレビュー作成フェーズ

### 4.1 プレビュー作成の前提条件

1. 計画書の完了確認
   - すべてのセクションが記載済み
   - エラー防止メカニズムの準備完了
   - ユーザーの承認取得

2. 必要な情報の確認
   - メンバー情報の把握
   - チームルールの理解
   - プロジェクトルールの確認

### 4.2 段階的な作成プロセス

1. 基本情報の組み込み
   - メンバー情報の反映
   - 技術特性の考慮
   - 作業スタイルの統合

2. ルール階層の構築
   - 個人ルールの優先度設定
   - チームルールとの整合性確保
   - プロジェクトルールの基盤化

3. 設定の最適化
   - 自動化設定の調整
   - エラー処理の追加
   - パフォーマンスの最適化

### 4.3 プレビューファイルの作成

```
docs/setup/cline/logs/ai/advice/[teamName]/[userName]/YYYY-MM-DD-HH-clinerules-preview.md
```

### 4.4 プレビュー構造

1. ファイル構成
   ```markdown
   # .clinerules プレビュー

   ## 1. 個人ルール設定
   ### 1.1 確認対象のルール
   ### 1.2 理解度判定基準
   ### 1.3 重点確認項目

   ## 2. チームルール設定
   ### 2.1 確認対象のルール
   ### 2.2 理解度判定基準
   ### 2.3 重点確認項目

   ## 3. プロジェクトルール設定
   ### 3.1 メモリバンクの基本概念
   ### 3.2 メモリバンクの構造と更新
   ### 3.3 ドキュメント更新の原則
   ### 3.4 Git運用ルール
   ### 3.5 プロジェクト基本ルール
   ### 3.6 トリガー処理ルール
   ```

2. 各セクションの記述ルール
   - 明確な階層構造を維持
   - 箇条書きでの記述を基本とする
   - サブセクションは適切にインデント

## 5. 作業フロー概要

### 5.1 計画フェーズ
- 計画書フォーマットの確認
- 計画書の作成
- 承認の取得

### 5.2 プレビューフェーズ
- プレビューの作成
- レビューと修正
- 承認の取得

### 5.3 実装フェーズ
- .clinerules の生成
- 検証の実施
- 最終承認の取得

## 6. 改善案の作成

### 6.1 AIの熟考プロセス

1. タスク履歴の確認
   - 過去のタスク実行状況
   - 成功/失敗の要因分析
   - 効率化可能なポイント

2. ユーザー特性の分析
   - コミュニケーションスタイル
   - 作業の優先順位付け方法
   - フィードバックの傾向

3. 改善方針の検討
   - トークン効率の向上
   - 理解しやすさの改善
   - エラー防止の仕組み

4. 実装可能性の評価
   - 技術的な実現性
   - 影響範囲の見積もり
   - リスクの分析
   - 効果の予測

### 6.2 改善提案の作成と保存

1. ファイル名規則
   ```
   docs/setup/cline/logs/ai/advice/[teamName]/[userName]/YYYY-MM/YYYY-MM-DD-HH-mm-[改善内容の英名].md
   ```

2. 提案フォーマット
   ```markdown
   # [改正したいルールのタイトル]改善提案

   ## 1. 変更内容
   [変更の具体的な内容]

   ## 2. 変更理由
   [なぜこの変更が最適なのか]

   ## 3. 影響範囲
   [この変更が影響を与える範囲]

   ## 4. 期待される効果
   [変更による具体的な改善点]
   ```

## 7. 改善案のユーザー確認

### 7.1 提案時の注意点

- 具体的な改善内容を示す
- 変更の理由を明確に説明
- トークン削減効果を予測
- 影響範囲を明示

### 7.2 フィードバック対応

- 修正要求への対応
- 変更履歴の管理
- 再提案の実施

## 8. .clinerules生成フェーズ

### 8.1 生成前の最終確認

```yaml
チェック項目:
  ユーザー特性:
    - 作業スタイルの反映
    - 重要な注意点の組込
    - 自動化設定の確認

  ルール階層:
    - 優先順位の正確性
    - 依存関係の整理
    - 矛盾点の解消

  セキュリティ:
    - 機密情報の扱い
    - アクセス制御の設定
    - エラー処理の確認
```

### 8.2 生成と検証

1. 自動チェックリスト
   ```yaml
   必須確認項目:
     メンバー情報:
       - 名前とチームの正確性
       - 役割の明確な記載
       - 技術レベルの反映

     設定値:
       - パスの正確性
       - 変数の整合性
       - 依存関係の確認

     セキュリティ:
       - 機密情報の除外
       - アクセス権の設定
       - エラー処理の実装
   ```

2. 手動確認項目
   - ユーザー要件との整合性
   - チームルールとの適合性
   - プロジェクト要件の遵守

3. 最終承認
   - ユーザーによる確認
   - 必要に応じた調整
   - 承認の記録

## 9. 継続的改善

### 9.1 作業記録の管理

1. ログの保存
   ```yaml
   記録項目:
     作業プロセス:
       - 実施した手順
       - 判断のポイント
       - 結果と効果

     問題と解決:
       - 発生した問題
       - 対応方法
       - 予防策

     改善提案:
       - 効率化のポイント
       - 新規アイデア
       - 検討事項
   ```

### 9.2 プロセス改善

1. 定期的な見直し
   - 手順の最適化
   - テンプレートの更新
   - ツールの改善

2. フィードバックの反映
   - ユーザーからの提案
   - 効率化の検討
   - 新規要件の取り込み
