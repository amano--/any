# Clineルール更新手順（AI用）

## 0. 重要な前提

- ルールのメンテナンスはユーザーの責任です
- AIは分析と更新作業を担当します
- ルールの更新は必ずユーザーの承認が必要です

## 1. ルール改善のトリガー

### 1.1 自動検知

以下のキーワードを含む文章を検出した場合：
- 「ルールの問題点が見つかりました」
- 「ルールの改善が必要です」
- 「ルールの更新を提案します」
- 「ルールの矛盾を発見しました」
- 「ルールの最適化が可能です」

### 1.2 手動トリガー

ユーザーから「ルール改善」命令を受けた場合

## 2. 既存ルールの分析

### 2.1 ルールディレクトリの確認

```bash
docs/setup/cline/rules/
├── personal.md       # 個人ルール
├── project.md        # プロジェクトルール
└── task/            # タスク定義ファイル
    ├── task1.md
    └── task2.md
```

### 2.2 分析内容

1. ルール間の整合性
   - 重複や矛盾の確認
   - 参照関係の確認
   - 更新必要箇所の特定

2. 形式の統一性
   - フォーマットの確認
   - インデントの確認
   - リンクの有効性確認

3. 内容の妥当性
   - 古くなった記述の確認
   - 不明確な説明の確認
   - 必要な補足の確認

## 3. 改善案の作成

### 3.1 AIの熟考プロセス

1. 過去の作業の振り返り
   - 実施したタスクの分析
   - 発生した問題点の整理
   - 非効率な手順の特定
   - エラーが起きやすい箇所の把握

2. ルールの利用状況分析
   - よく使用されるルールの特定
   - 問題が発生しやすい箇所
   - 理解しにくい部分の特定
   - トークン効率の低い箇所

3. 改善方針の検討
   - トークン効率の向上
   - 理解しやすさの改善
   - エラー防止の仕組み
   - 保守性の向上

4. 実装可能性の評価
   - 技術的な実現性
   - 影響範囲の見積もり
   - リスクの分析
   - 効果の予測

### 3.2 改善提案の作成と保存

1. ファイル名規則
```
docs/setup/cline/rules/logs/ai/advice/YYYY-MM-DD-HH-[改善内容の英名].md

例：
2025-03-09-08-rule-structure-optimization.md
```

2. 提案フォーマット
```markdown
# ルール改善提案

## 1. 概要

### 対象ファイル
[改善対象のファイルパス]

### 改善の動機
[なぜこの改善が必要か、簡潔に説明]

### 期待される成果
[この改善によって得られる具体的な効果]

## 2. 現状の課題

### 2.1 問題点
- [具体的な問題点を箇条書きで列挙]
- [各問題点は明確で具体的に]

### 2.2 影響範囲
- [この問題が影響を与えている範囲]
- [関連するファイルやプロセス]

## 3. 改善提案

### 3.1 変更内容
```diff
- [削除する部分]
+ [追加する部分]
```

### 3.2 変更理由
[なぜこの変更が最適なのか、技術的な根拠を含めて説明]

## 4. 実装計画

### 4.1 実装手順
1. [具体的な実装ステップ]
2. [各ステップの詳細]

### 4.2 検証項目
- [実装後の確認ポイント]
- [期待される動作や結果]

## 5. リスク評価

### 5.1 潜在的な問題
- [予想される問題点]
- [対応策]

### 5.2 代替案
- [他の解決方法]
- [採用しなかった理由]
```

### 3.3 提案時の注意点

- 具体的な改善内容を示す
- 変更の理由を明確に説明
- トークン削減効果を予測
- 影響範囲を明示

## 4. ユーザー承認後の作業

### 4.1 英語版の作成

1. ファイル配置と命名規則
   ```
   # 日本語版と同じファイル名を維持
   日本語版：docs/setup/cline/rules/task/auto-commit-by-task.md
   英語版　：docs/setup/cline/rules/en/task/auto-commit-by-task.md

   # ディレクトリ構造も維持
   日本語版のパスの rules/ 直下に en/ を追加
   ```

2. 作成のポイント
   - 簡潔な英語表現の使用
   - 必要最小限の説明
   - 技術的な正確性の維持
   - トークン数の最小化を重視

3. リンクの更新
   - 相対パスの維持
   - 英語版間のリンクを確認
   - 日本語版とのクロスリファレンス確認

### 4.2 .clinerules の更新

1. mk-clinerules.sh の実行
   ```bash
   cd docs/setup/cline
   ./mk-clinerules.sh
   ```

2. 更新結果の確認
   - 生成された内容の確認
   - リンクの有効性確認
   - フォーマットの確認

## 5. エラー発生時の対応

### 5.1 生成エラー

1. エラーメッセージの確認
2. 英語版の修正
3. 再生成の実行

### 5.2 構文エラー

1. Markdown構文の確認
2. インデントの修正
3. フォーマットの調整

## 6. コミット手順

### 6.1 コミットメッセージ形式

```
feat(rules): ルールの変更内容を簡潔に

- 変更点1
- 変更点2
- 変更点3

# プロンプト履歴

1. Q: [ユーザーからの指示]
   A: [AIの対応内容]
```

### 6.2 実行コマンド

```bash
git add docs/setup/cline/rules/en/[変更ファイル]
git add docs/setup/cline/rules/[変更ファイル]
git add .clinerules
git commit -m "[コミットメッセージ]"
