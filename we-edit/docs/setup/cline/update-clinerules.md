# Clineルール更新手順（AI用）

## 0. 重要な前提

- ルールのメンテナンスはユーザーの責任です
- AIは分析と更新作業を担当します
- ルールの更新は必ずユーザーの承認が必要です

## 1. ルール改善のトリガー

### 1.1 自動検知

以下のキーワードを含む文章を検出した場合：
- 「ルールの問題点が見つかりました」
- 「ルールの改善が必要です」
- 「ルールの更新を提案します」
- 「ルールの矛盾を発見しました」
- 「ルールの最適化が可能です」

### 1.2 手動トリガー

ユーザーから「ルール改善」命令を受けた場合

## 2. 既存ルールの分析

### 2.1 ルールディレクトリの確認

```bash
docs/setup/cline/rules/
├── personal.md       # 個人ルール
├── project.md        # プロジェクトルール
└── task/            # タスク定義ファイル
    ├── task1.md
    └── task2.md
```

### 2.2 分析内容

1. ルール間の整合性
   - 重複や矛盾の確認
   - 参照関係の確認
   - 更新必要箇所の特定

2. 形式の統一性
   - フォーマットの確認
   - インデントの確認
   - リンクの有効性確認

3. 内容の妥当性
   - 古くなった記述の確認
   - 不明確な説明の確認
   - 必要な補足の確認

## 3. 改善案の作成

### 3.1 改善提案の形式

```markdown
# ルール改善提案

## 1. 改善が必要な箇所

1. ファイル：[対象ファイルパス]
   - 現在の記述：[該当部分]
   - 問題点：[具体的な問題]
   - 改善案：[新しい記述]
   - 理由：[変更が必要な理由]

2. ファイル：[対象ファイルパス]
   ...

## 2. 期待される効果

- [改善による具体的な効果]
- [トークン削減の見込み]
- [保守性向上のポイント]

## 3. 影響範囲

- [変更の影響を受けるファイル]
- [更新が必要な関連ルール]
- [変更後の検証ポイント]
```

### 3.2 提案時の注意点

- 具体的な改善内容を示す
- 変更の理由を明確に説明
- トークン削減効果を予測
- 影響範囲を明示

## 4. ユーザー承認後の作業

### 4.1 英語版の作成

1. 配置場所
   ```
   docs/setup/cline/rules/en/[カテゴリ]/[ファイル名].md
   ```

2. 作成のポイント
   - 簡潔な英語表現の使用
   - 必要最小限の説明
   - 技術的な正確性の維持

### 4.2 .clinerules の更新

1. mk-clinerules.sh の実行
   ```bash
   cd docs/setup/cline
   ./mk-clinerules.sh
   ```

2. 更新結果の確認
   - 生成された内容の確認
   - リンクの有効性確認
   - フォーマットの確認

## 5. エラー発生時の対応

### 5.1 生成エラー

1. エラーメッセージの確認
2. 英語版の修正
3. 再生成の実行

### 5.2 構文エラー

1. Markdown構文の確認
2. インデントの修正
3. フォーマットの調整

## 6. コミット手順

### 6.1 コミットメッセージ形式

```
feat(rules): ルールの変更内容を簡潔に

- 変更点1
- 変更点2
- 変更点3

# プロンプト履歴

1. Q: [ユーザーからの指示]
   A: [AIの対応内容]
```

### 6.2 実行コマンド

```bash
git add docs/setup/cline/rules/en/[変更ファイル]
git add docs/setup/cline/rules/[変更ファイル]
git add .clinerules
git commit -m "[コミットメッセージ]"
